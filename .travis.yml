sudo: required
env:
  global:
# SONAR_GITHUB_TOKEN
  - secure: TODO_SONAR_GITHUB_TOKEN
# GITHUB_TOKEN
  - secure: TODO_GITHUB_TOKEN
addons:
  apt:
    sources:
    - google-chrome
    packages:
    - google-chrome-stable
addons:
  sonarqube:
    branches:
    - master
    - devel
language: node_js
node_js:
- "node"
- "lts/*"
- "8"
- "7"
- "6"
before_install:
- export CHROME_BIN=chromium-browser
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
intall:
- npm install
before_script:
- npm run build
script:
- npm start &
- sleep 10
- npm run e2e

after_script:
- sonar-scanner -X -Dsonar.login=${SONAR_GITHUB_TOKEN} -Dsonar.host.url=http://qalab.tk:82